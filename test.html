<script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
<script src="https://cdn.jsdelivr.net/npm/iris-lib/dist/iris.js"></script>

<script>
    var gun1
    var gun2
    var myKey
    var someoneElse    
    var ourChannel
    var theirChannel
    var myChannels    

    (async ()=>{
        // Copy & paste this to console at https://iris.to or other page that has gun, sea and iris-lib
        // Due to an unsolved bug, someoneElse's messages only start showing up after a reload

        gun1 = new Gun('https://gun-us.herokuapp.com/gun');
        gun2 = new Gun('https://gun-us.herokuapp.com/gun');
        myKey = await iris.Key.generate();
        someoneElse = await iris.Key.generate();

        iris.Channel.initUser(gun1, myKey); // saves myKey.epub to gun.user().get('epub')
        iris.Channel.initUser(gun2, someoneElse);

        ourChannel = new iris.Channel({key: myKey, gun: gun1, participants: someoneElse.pub});
        theirChannel = new iris.Channel({key: someoneElse, gun: gun2, participants: myKey.pub});

        myChannels = {}; // you can list them in a user interface
        function printMessage(msg, info) {
            console.log(`[${new Date(msg.time).toLocaleString()}] ${info.from.slice(0,8)}: ${msg.text}`)
        }
        iris.Channel.getChannels(gun1, myKey, channel => {
            channel.getMessages(printMessage);
        });
    })()    
</script>