<script src="https://cdn.jsdelivr.net/npm/gun/gun.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gun/sea.js"></script>
<script src="https://cdn.jsdelivr.net/npm/iris-lib/dist/iris.js"></script>

<script>
    var gun1
    var gun2
    var myKey
    var someoneElse    
    var ourChannel
    var theirChannel
    var myChannels    

    function step1(){
        gun1 = new Gun('https://gun-us.herokuapp.com/gun');
        gun2 = new Gun('https://gun-us.herokuapp.com/gun');
        myKey = 
                {
                "pub": "1VUz-4DbHQuPNEegcrX9PiJ-AThJBzLJRWcwKjZUZtQ.eYfDGo-7bKoFGFqI_IW5wCkgYmZqNrgWcDH6HPixug4",
                "priv": "Q6ptZqcbjpEiyh12jUmuDQNzoKKKZzxa1Kc42E7_g8c",
                "epub": "zegUAdNkuEUWJtXyZBS6BDP0gOcLj7evNaDwn-ppLZM.phQlQQFKS5LlpSvVFSiMOgsT16C1FKjvjsa50Lqbt5k",
                "epriv": "D_FEqaOFGeaJIuTlal-PjzgUjwjrmgEcO9mPM7KOFGA"
                }        
        someoneElse = 
                {
                "pub": "RuKLB_-O0eg-D09uEeHdLgayca5DNzXOfpch8D5jclA.b63WOrMEFKzBy8FIeatl55FqpAnkBIIM8o1uz_6XiGo",
                "priv": "z6M4QQYuPCU-rs6dOCDDmrF1Fj2c5H1wn0P3l0Wf44k",
                "epub": "B00UC6NLjWWLFbjJg_KxBvgdQTFvgq_Wq5c0DQmlXho.h_ZpbIxw9KCCL0_F-uqE5QG5tDpQjGYClsGO8ZEaSB0",
                "epriv": "oWMpROJqm3i0j9uxEn6XXwy2W5v9R2YRMVsCsI6tJXk"
                }        
 
        iris.Channel.initUser(gun1, myKey); // saves myKey.epub to gun.user().get('epub')
        iris.Channel.initUser(gun2, someoneElse);

        ourChannel = new iris.Channel({key: myKey, gun: gun1, participants: someoneElse.pub});
        theirChannel = new iris.Channel({key: someoneElse, gun: gun2, participants: myKey.pub});

        iris.Channel.getChannels(gun1, myKey, channel => {
            channel.getMessages(printMessage);
        });
    }

    function printMessage(msg, info) {
        console.log(`[${new Date(msg.time).toLocaleString()}] ${info.from.slice(0,8)}: ${msg.text}`)
    }

</script>

<button onclick="step1()">Step 1</button>
<button onclick="step2()">Step 2</button>